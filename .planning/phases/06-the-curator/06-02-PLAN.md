---
phase: 06-the-curator
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/sade_agents/skills/curator_skills.py
  - src/sade_agents/skills/__init__.py
autonomous: true
user_setup:
  - service: gemini
    why: "Gorsel uretim icin Gemini API"
    env_vars:
      - name: GEMINI_API_KEY
        source: "Google AI Studio -> Get API key (https://aistudio.google.com/apikey)"

must_haves:
  truths:
    - "gorsel_tasarla skill'i urun bilgisi alip prompt olusturur"
    - "Skill style_guide dosyalarini okuyup prompta dahil eder"
    - "Gemini API cagirisi mock edilmis (gercek API sonraki planda)"
    - "Skill sade_agents.skills'den import edilebilir"
  artifacts:
    - path: "src/sade_agents/skills/curator_skills.py"
      provides: "Gorsel tasarim skill fonksiyonu"
      exports: ["gorsel_tasarla"]
      min_lines: 80
    - path: "src/sade_agents/skills/__init__.py"
      provides: "Skills modul exportlari"
      contains: "gorsel_tasarla"
  key_links:
    - from: "src/sade_agents/skills/curator_skills.py"
      to: "style_guide/*.json"
      via: "JSON file loading"
      pattern: "json\\.load|Path.*style_guide"
    - from: "src/sade_agents/skills/__init__.py"
      to: "curator_skills.py"
      via: "module import"
      pattern: "from.*curator_skills.*import"
---

<objective>
The Curator icin gorsel tasarim skill'i - Gemini API icin prompt olusturma ve style guide entegrasyonu.

Purpose: CuratorAgent'in kullanacagi `gorsel_tasarla` skill fonksiyonunu olusturur. Bu skill urun bilgisini alip, style guide'dan stil direktiflerini okuyup, Gemini API icin optimize edilmis narrative prompt uretir.

Output: curator_skills.py icinde CrewAI @tool decoratoru ile tanimlanmis skill fonksiyonu.
</objective>

<execution_context>
@C:\Users\Hp\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Hp\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06-the-curator/06-CONTEXT.md
@.planning/phases/06-the-curator/06-RESEARCH.md
@src/sade_agents/skills/alchemist_skills.py
@src/sade_agents/skills/__init__.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Curator Skills - gorsel_tasarla Fonksiyonu</name>
  <files>src/sade_agents/skills/curator_skills.py</files>
  <action>
`src/sade_agents/skills/curator_skills.py` olustur. Mevcut skill pattern'ini takip et (alchemist_skills.py referans).

```python
"""
Sade Chocolate - The Curator Skills.

Gorsel tasarim ve etiket uretimi icin skill fonksiyonlari.
Gemini 3 Pro Image API ile entegre calisir.
"""

import json
import os
from pathlib import Path
from typing import Literal

from crewai.tools import tool

# Style guide paths
STYLE_GUIDE_DIR = Path(__file__).parent.parent.parent.parent / "style_guide"

def _load_style_config() -> dict:
    """Style guide konfigurasyonunu yukle."""
    config_path = STYLE_GUIDE_DIR / "style_config.json"
    if config_path.exists():
        with open(config_path, "r", encoding="utf-8") as f:
            return json.load(f)
    return {"aesthetic": "quiet_luxury", "style_keywords": ["elegant", "minimalist"]}

def _load_brand_colors() -> dict:
    """Marka renk paletini yukle."""
    colors_path = STYLE_GUIDE_DIR / "brand_colors.json"
    if colors_path.exists():
        with open(colors_path, "r", encoding="utf-8") as f:
            return json.load(f)
    return {"primary": "#3D2314", "secondary": "#F5F0E8"}

def _build_label_prompt(urun_adi: str, urun_gramaj: str, urun_aciklama: str, style_config: dict, colors: dict) -> str:
    """Gemini icin narrative prompt olustur."""
    keywords = ", ".join(style_config.get("style_keywords", ["elegant"]))
    avoid = ", ".join(style_config.get("avoid_keywords", ["flashy"]))

    # Max 25 karakter etiket metni
    label_text = f"{urun_adi} {urun_gramaj}"
    if len(label_text) > 25:
        label_text = label_text[:22] + "..."

    prompt = f"""
Create a premium product label for a quiet luxury chocolate brand named Sade.

Product: {urun_adi} - {urun_aciklama}
Label Text: "{label_text}" (render this text clearly)

Design Aesthetic:
{keywords}

Color Palette:
- Primary (chocolate): {colors.get('primary', {}).get('hex', '#3D2314')}
- Secondary (cream): {colors.get('secondary', {}).get('hex', '#F5F0E8')}
- Use neutral, muted tones throughout

Composition:
- {style_config.get('composition', {}).get('layout', 'minimalist, centered')}
- {style_config.get('composition', {}).get('white_space', 'ample white space')}
- Typography: elegant serif or clean sans-serif, excellent legibility

AVOID: {avoid}

The design should feel timeless, sophisticated, and whisper luxury rather than shout it.
Render the text clearly with proper spacing for print-ready output at 300 DPI.
"""
    return prompt.strip()

@tool
def gorsel_tasarla(
    urun_adi: str,
    urun_gramaj: str = "50g",
    urun_aciklama: str = "",
    mod: Literal["prompt", "varyasyon_prompt", "bilgi"] = "prompt"
) -> str:
    """
    Urun etiketi icin gorsel tasarim promptu ve bilgisi uretir.

    Bu skill, The Curator agent'in gorsel tasarim workflow'unu destekler.
    Gemini 3 Pro Image API icin optimize edilmis narrative promptlar olusturur.

    Args:
        urun_adi: Urun adi (ornek: "Antep Fistikli", "Ruby Tablet")
        urun_gramaj: Urun gramaji (ornek: "50g", "85g", "100g")
        urun_aciklama: Urun aciklamasi/lezzet notlari
        mod: Islem modu
            - "prompt": Tek bir tasarim promptu olustur
            - "varyasyon_prompt": 3-4 varyasyon icin prompt seti olustur
            - "bilgi": Style guide ve specs bilgisi dondur

    Returns:
        Gemini API icin hazir prompt veya bilgi metni

    Ornek:
        gorsel_tasarla("Bitter Orange", "85g", "Portakal parcali bitter cikolata")
        gorsel_tasarla("Ruby Tablet", mod="varyasyon_prompt")
    """
    sections = []

    # Style config ve renkleri yukle
    style_config = _load_style_config()
    brand_colors = _load_brand_colors()

    if mod == "bilgi":
        # Style guide bilgisi
        sections.append("# Sade Chocolate - Gorsel Stil Kilavuzu\n")
        sections.append(f"**Estetik:** {style_config.get('aesthetic', 'quiet_luxury')}")
        sections.append(f"**Stil Anahtar Kelimeleri:** {', '.join(style_config.get('style_keywords', []))}")
        sections.append(f"**Kacinilacaklar:** {', '.join(style_config.get('avoid_keywords', []))}")

        specs = style_config.get('label_specs', {})
        sections.append("\n## Etiket Teknik Ozellikleri")
        sections.append(f"- Aspect Ratio: {specs.get('aspect_ratio', '3:4')}")
        sections.append(f"- Cozunurluk: {specs.get('resolution', '2K')}")
        sections.append(f"- Max Metin: {specs.get('text_max_chars', 25)} karakter")
        sections.append(f"- DPI: {specs.get('dpi', 300)}")

        sections.append("\n## Renk Paleti")
        for color_name, color_data in brand_colors.items():
            if isinstance(color_data, dict):
                sections.append(f"- {color_name}: {color_data.get('hex', 'N/A')} - {color_data.get('usage', '')}")

        return "\n".join(sections)

    elif mod == "varyasyon_prompt":
        # 3 varyasyon icin farkli yaklasimlari vurgulayan promptlar
        sections.append(f"# Etiket Varyasyonlari: {urun_adi} {urun_gramaj}\n")
        sections.append("3 farkli varyasyon icin Gemini'ye gonderilecek promptlar:\n")

        base_prompt = _build_label_prompt(urun_adi, urun_gramaj, urun_aciklama, style_config, brand_colors)

        variations = [
            ("Klasik Minimalist", "Focus on extreme minimalism. Single focal point, maximum white space, text as the hero element."),
            ("Organik Dokulu", "Add subtle organic texture (paper grain, fabric weave). Warm, tactile feeling while maintaining elegance."),
            ("Geometrik Sofistike", "Introduce subtle geometric elements (thin lines, gentle shapes). Modern sophistication, architectural feel.")
        ]

        for i, (var_name, var_addition) in enumerate(variations, 1):
            sections.append(f"## Varyasyon {i}: {var_name}")
            sections.append(f"```\n{base_prompt}\n\nVariation Focus: {var_addition}\n```\n")

        sections.append("\n---")
        sections.append("## Agent Talimatlari")
        sections.append("1. Her varyasyonu sirayla Gemini API'ye gonder")
        sections.append("2. Sonuclari outputs/labels/{urun_adi}/v1/ klasorune kaydet")
        sections.append("3. Kullaniciya 3 varyasyonu sun, secim bekle")
        sections.append("4. Secilen varyasyonu refinement icin hazir tut")

        return "\n".join(sections)

    else:  # mod == "prompt"
        # Tek prompt
        prompt = _build_label_prompt(urun_adi, urun_gramaj, urun_aciklama, style_config, brand_colors)

        sections.append(f"# Etiket Tasarim Promptu: {urun_adi}\n")
        sections.append("Gemini 3 Pro Image API icin hazir prompt:\n")
        sections.append(f"```\n{prompt}\n```")

        sections.append("\n---")
        sections.append("## Teknik Notlar")
        specs = style_config.get('label_specs', {})
        sections.append(f"- Aspect Ratio: {specs.get('aspect_ratio', '3:4')}")
        sections.append(f"- Cozunurluk: {specs.get('resolution', '2K')}")
        sections.append(f"- Format: PNG (300 DPI)")

        sections.append("\n## Agent Talimatlari")
        sections.append("1. Bu promptu Gemini API'ye gonder")
        sections.append("2. Uretilen gorseli degerlendirmek icin kullaniciya sun")
        sections.append("3. Refinement talepleri varsa conversational editing uygula")

        return "\n".join(sections)


__all__ = ["gorsel_tasarla"]
```

**Onemli Notlar:**
- Style guide dosyalarini dinamik olarak oku (hardcode etme)
- Prompt narrative formatta (keyword listesi degil - Gemini best practice)
- Max 25 karakter text limit (Gemini text rendering)
- Turkce docstring ve aciklamalar
- Mevcut skill pattern'ini takip et (alchemist_skills.py gibi)
  </action>
  <verify>
    - `python -c "from sade_agents.skills.curator_skills import gorsel_tasarla; print(gorsel_tasarla)"` import basarili
    - `python -c "from sade_agents.skills.curator_skills import gorsel_tasarla; print(gorsel_tasarla('Test', '50g', 'aciklama', 'bilgi'))"` cikti uretir
    - Dosyada `@tool` decorator kullanilmis
    - Dosyada `_load_style_config` ve `_load_brand_colors` fonksiyonlari var
  </verify>
  <done>
    - gorsel_tasarla skill fonksiyonu 3 modda calisir (prompt, varyasyon_prompt, bilgi)
    - Style guide dosyalarini okur ve prompta entegre eder
    - Gemini API icin optimize edilmis narrative prompt uretir
    - Max 25 karakter text limiti uygulanir
    - Turkce docstring ve aciklamalar mevcut
  </done>
</task>

<task type="auto">
  <name>Task 2: Skills Module Export Guncelleme</name>
  <files>src/sade_agents/skills/__init__.py</files>
  <action>
`src/sade_agents/skills/__init__.py` dosyasini guncelle - gorsel_tasarla'yi ekle.

Mevcut dosyayi oku, sonra su sekilde guncelle:

```python
"""
Sade Chocolate - Agent Skills/Tools.

Her agent'in kullandigi skill fonksiyonlari.
CrewAI @tool decorator ile tanimlanmis.
"""

from sade_agents.skills.alchemist_skills import lezzet_pisileri
from sade_agents.skills.curator_skills import gorsel_tasarla
from sade_agents.skills.growth_skills import sosyal_nabiz
from sade_agents.skills.narrator_skills import hikayelestir
from sade_agents.skills.pricing_skills import fiyat_kontrol

__all__ = [
    "lezzet_pisileri",
    "gorsel_tasarla",
    "sosyal_nabiz",
    "hikayelestir",
    "fiyat_kontrol",
]
```

**Not:** Mevcut exportlari koru, sadece `gorsel_tasarla` ekle.
  </action>
  <verify>
    - `python -c "from sade_agents.skills import gorsel_tasarla; print(gorsel_tasarla)"` basarili
    - `python -c "from sade_agents.skills import lezzet_pisileri, gorsel_tasarla, sosyal_nabiz"` tum importlar calisir
    - __init__.py icinde __all__ listesi guncel
  </verify>
  <done>
    - gorsel_tasarla sade_agents.skills'den import edilebilir
    - Mevcut skill exportlari bozulmadi
    - __all__ listesi guncel
  </done>
</task>

</tasks>

<verification>
- [ ] curator_skills.py olusturuldu ve @tool decorator kullaniyor
- [ ] gorsel_tasarla 3 modda calisir (prompt, varyasyon_prompt, bilgi)
- [ ] Style guide dosyalari dinamik olarak okunuyor
- [ ] Max 25 karakter text limiti uygulanÄ±yor
- [ ] Skills __init__.py guncellendi
- [ ] Import testleri basarili
</verification>

<success_criteria>
- `from sade_agents.skills import gorsel_tasarla` calisir
- gorsel_tasarla("Test Urun", "50g", "aciklama", "prompt") gecerli Gemini promptu dondurur
- gorsel_tasarla(mod="bilgi") style guide bilgisini dondurur
- Turkce docstring ve aciklamalar mevcut
- Mevcut codebase pattern'leri takip edilmis
</success_criteria>

<output>
After completion, create `.planning/phases/06-the-curator/06-02-SUMMARY.md`
</output>
