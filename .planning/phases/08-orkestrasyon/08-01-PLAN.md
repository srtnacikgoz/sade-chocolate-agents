---
phase: 08-orkestrasyon
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/sade_agents/models/workflow_models.py
  - src/sade_agents/models/__init__.py
  - src/sade_agents/crews/__init__.py
  - src/sade_agents/crews/base_crew.py
autonomous: true

must_haves:
  truths:
    - "Workflow inputs can be validated before crew execution"
    - "Workflow outputs have structured Pydantic format"
    - "Base crew utilities exist for composition"
  artifacts:
    - path: "src/sade_agents/models/workflow_models.py"
      provides: "ProductLaunchInput/Output, MarketAnalysisInput/Output, QualityAuditInput/Output"
      min_lines: 80
    - path: "src/sade_agents/crews/base_crew.py"
      provides: "Base crew helper functions"
      min_lines: 30
  key_links:
    - from: "src/sade_agents/models/workflow_models.py"
      to: "pydantic"
      via: "BaseModel inheritance"
      pattern: "class.*\\(BaseModel\\)"
---

<objective>
Create Pydantic workflow models and base crew utilities for Phase 8 orchestration.

Purpose: Enable type-safe, validated inputs/outputs for multi-agent workflows. Establish foundation for specialized crew compositions.
Output: workflow_models.py with 6 Pydantic models, base_crew.py with helper utilities
</objective>

<execution_context>
@C:\Users\Hp\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Hp\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-orkestrasyon/08-RESEARCH.md

@src/sade_agents/models/audit_result.py
@src/sade_agents/agents/__init__.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Pydantic workflow models</name>
  <files>
    src/sade_agents/models/workflow_models.py
    src/sade_agents/models/__init__.py
  </files>
  <action>
Create `src/sade_agents/models/workflow_models.py` with 6 Pydantic models:

1. **ProductLaunchInput** - Input for product development workflow
   - `flavor_concept: str` - Flavor description (e.g., "Antep Fistikli")
   - `target_audience: str` - Target segment (default: "Quiet luxury consumers")
   - `price_range: tuple[float, float]` - Min/max price (default: (100, 200))
   - `include_audit: bool` - Whether to run Perfectionist audit (default: True)

2. **ProductLaunchOutput** - Output from product development workflow
   - `recipe: dict` - Alchemist recipe output
   - `story: dict` - Narrator story/caption/note
   - `label_paths: list[str]` - Curator generated label paths
   - `audit: Optional[AuditResult]` - Perfectionist audit if requested
   - `execution_time_seconds: float` - Total execution time

3. **MarketAnalysisInput** - Input for market analysis workflow
   - `competitor_name: str` - Competitor to analyze (e.g., "Vakko")
   - `product_category: str` - Category focus (default: "premium chocolate")
   - `include_trends: bool` - Include GrowthHacker trends (default: True)

4. **MarketAnalysisOutput** - Output from market analysis workflow
   - `pricing_analysis: dict` - PricingAnalyst output
   - `trend_report: Optional[dict]` - GrowthHacker output if requested
   - `summary: str` - Narrator summary of findings
   - `execution_time_seconds: float`

5. **QualityAuditInput** - Input for quality audit workflow
   - `content: str` - Content to audit
   - `content_type: Literal["metin", "gorsel_prompt", "fiyat_analizi", "trend_raporu", "recete"]`
   - `source_agent: Literal["narrator", "curator", "pricing", "growth", "alchemist"]`

6. **QualityAuditOutput** - Output from quality audit workflow
   - `audit_result: AuditResult` - Structured audit result
   - `passed: bool` - Whether content meets threshold
   - `execution_time_seconds: float`

All models should have:
- Docstrings in Turkish explaining purpose
- `Config.json_schema_extra` with realistic examples
- Field descriptions using `Field(description="...")`

Update `src/sade_agents/models/__init__.py` to export all new models.
  </action>
  <verify>
    python -c "from sade_agents.models import ProductLaunchInput, ProductLaunchOutput, MarketAnalysisInput, MarketAnalysisOutput, QualityAuditInput, QualityAuditOutput; print('All workflow models imported successfully')"
  </verify>
  <done>
    6 Pydantic workflow models exist with validation, all importable from sade_agents.models
  </done>
</task>

<task type="auto">
  <name>Task 2: Create base crew utilities</name>
  <files>
    src/sade_agents/crews/__init__.py
    src/sade_agents/crews/base_crew.py
  </files>
  <action>
Create `src/sade_agents/crews/` directory structure:

1. **src/sade_agents/crews/__init__.py** - Package init, empty for now (will be populated in Plan 02)

2. **src/sade_agents/crews/base_crew.py** - Base utilities:

```python
"""
Sade Chocolate - Base Crew Utilities.

Yardimci fonksiyonlar ve base class'lar.
"""

import time
from typing import Callable, TypeVar
from crewai import Task
from sade_agents.agents.base import SadeAgent

T = TypeVar("T")


def create_task_with_context(
    description: str,
    expected_output: str,
    agent: SadeAgent,
    context: list[Task] | None = None,
) -> Task:
    """
    Task olusturur, context dependency'leri ile.

    Args:
        description: Gorev aciklamasi
        expected_output: Beklenen cikti formati
        agent: Gorevi calistiracak agent
        context: Bagimli oldugu onceki task'lar (optional)

    Returns:
        Configured Task instance
    """
    task_kwargs = {
        "description": description,
        "expected_output": expected_output,
        "agent": agent,
    }
    if context:
        task_kwargs["context"] = context

    return Task(**task_kwargs)


def timed_execution(func: Callable[..., T]) -> Callable[..., tuple[T, float]]:
    """
    Fonksiyon calisma suresini olcer.

    Decorator olarak kullanilabilir.
    Returns tuple of (result, execution_time_seconds).
    """
    def wrapper(*args, **kwargs) -> tuple[T, float]:
        start = time.time()
        result = func(*args, **kwargs)
        elapsed = time.time() - start
        return result, elapsed
    return wrapper


def requires_approval(agent: SadeAgent) -> bool:
    """
    Agent'in onay gerektirip gerektirmedigini kontrol eder.

    Returns:
        True if agent.autonomy_level in ["supervised", "mixed"]
    """
    return agent.autonomy_level in ("supervised", "mixed")


__all__ = [
    "create_task_with_context",
    "timed_execution",
    "requires_approval",
]
```

Ensure the crews directory is properly structured as a Python package.
  </action>
  <verify>
    python -c "from sade_agents.crews.base_crew import create_task_with_context, timed_execution, requires_approval; print('Base crew utilities imported')"
  </verify>
  <done>
    crews/ package exists with base_crew.py utilities, all importable
  </done>
</task>

</tasks>

<verification>
Run all verification commands:
```bash
python -c "from sade_agents.models import ProductLaunchInput, ProductLaunchOutput, MarketAnalysisInput, MarketAnalysisOutput, QualityAuditInput, QualityAuditOutput"
python -c "from sade_agents.crews.base_crew import create_task_with_context, timed_execution, requires_approval"
python -m pytest tests/ -v --tb=short 2>/dev/null || echo "Tests skipped (no tests yet)"
```
</verification>

<success_criteria>
- 6 Pydantic workflow models defined with validation
- All models exportable from sade_agents.models
- crews/ package created with base_crew.py
- Helper functions (create_task_with_context, timed_execution, requires_approval) work
- No import errors when importing models or utilities
</success_criteria>

<output>
After completion, create `.planning/phases/08-orkestrasyon/08-01-SUMMARY.md`
</output>
