---
phase: 03-the-pricing-analyst
plan: 02
type: execute
domain: skills
---

<objective>
Competitor Watchdog skill oluştur - rakip fiyatlarını web scraping ile çeker.

Purpose: /fiyat_kontrol komutuyla rakip çikolata markalarının fiyatlarını takip etme.
Output: Çalışır fiyat_kontrol skill'i, PricingAnalystAgent'a entegre.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Bu plan önceki plan'a bağlı:
@.planning/phases/03-the-pricing-analyst/03-01-SUMMARY.md

# Pattern için:
@src/sade_agents/skills/narrator_skills.py
@src/sade_agents/agents/narrator.py

# Domain bilgisi:
@skills/finance/capability_manifest.md

**Tech stack available:** CrewAI @tool decorator, requests, BeautifulSoup
**Established patterns:** crewai-tool-decorator, skill-as-prompt-template
**Rakip siteler:**
- vakkolatelier.com
- Hepsiburada ve Trendyol'da Vakko/Butterfly ürünleri

**Constraining decisions:**
- Phase 02-02: CrewAI @tool decorator ile skill tanımlama
</context>

<tasks>

<task type="auto">
  <name>Task 1: fiyat_kontrol skill oluştur</name>
  <files>src/sade_agents/skills/pricing_skills.py</files>
  <action>
fiyat_kontrol skill'ini CrewAI @tool decorator ile oluştur.

İki yaklaşım seçeneği var:
1. Gerçek web scraping (BeautifulSoup + requests)
2. Mock data + prompt template (hikayelestir gibi)

Bu aşamada MOCK DATA yaklaşımı kullan çünkü:
- Web scraping sitelere bağımlı, kırılgan
- LLM analiz yapabilmesi için format önemli
- İleride gerçek scraping eklenebilir

Skill yapısı:
```python
@tool
def fiyat_kontrol(rakip: str = "tumu") -> str:
    """
    Rakip çikolata markalarının fiyatlarını kontrol eder.

    Args:
        rakip: Kontrol edilecek rakip ("vakko", "butterfly", "divan", "tumu")

    Returns:
        Rakip fiyat raporu (TL/gram bazında)
    """
```

Mock data örneği:
- Vakko Sütlü Tablet 100g: 450 TL (4.50 TL/g)
- Butterfly Bitter 80g: 320 TL (4.00 TL/g)
- Divan Fındıklı 90g: 280 TL (3.11 TL/g)

Prompt template: Fiyat verilerini analiz edip:
1. En pahalı/ucuz rakip
2. TL/gram karşılaştırması
3. Sade için fiyat pozisyonu önerisi

NOT: Gerçek scraping daha sonra opsiyonel olarak eklenebilir.
  </action>
  <verify>python -c "from sade_agents.skills.pricing_skills import fiyat_kontrol; print(fiyat_kontrol.name)"</verify>
  <done>fiyat_kontrol skill import edilebilir ve CrewAI tool olarak çalışır</done>
</task>

<task type="auto">
  <name>Task 2: PricingAnalystAgent'a skill ekle</name>
  <files>src/sade_agents/agents/pricing_analyst.py, src/sade_agents/skills/__init__.py</files>
  <action>
1. pricing_skills.py'deki fiyat_kontrol'u skills/__init__.py'ye ekle
2. PricingAnalystAgent'ta tools=[fiyat_kontrol] yap

NarratorAgent + hikayelestir pattern'ini takip et.
  </action>
  <verify>python -c "from sade_agents.agents import PricingAnalystAgent; a = PricingAnalystAgent(); print([t.name for t in a.tools])"</verify>
  <done>PricingAnalystAgent.tools listesi fiyat_kontrol içerir</done>
</task>

</tasks>

<verification>
Tamamlanmadan önce:
- [ ] fiyat_kontrol skill import edilebilir
- [ ] PricingAnalystAgent.tools fiyat_kontrol içerir
- [ ] Skill çağrıldığında mock fiyat verisi + analiz prompt'u döner
</verification>

<success_criteria>

- fiyat_kontrol skill oluşturuldu
- CrewAI @tool decorator kullanıldı
- Mock rakip fiyat verisi mevcut
- Analiz prompt template'i mevcut
- PricingAnalystAgent'a entegre edildi
</success_criteria>

<output>
Tamamlandığında `.planning/phases/03-the-pricing-analyst/03-02-SUMMARY.md` oluştur.
</output>
