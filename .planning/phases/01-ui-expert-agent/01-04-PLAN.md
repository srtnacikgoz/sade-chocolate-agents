---
phase: 01-ui-expert-agent
plan: 04
type: execute
wave: 3
depends_on: ["01-02", "01-03"]
files_modified:
  - src/sade_agents/agents/ui_expert.py
  - src/sade_agents/agents/__init__.py
autonomous: true

must_haves:
  truths:
    - "UIExpertAgent SadeAgent'i extend ediyor"
    - "Agent design_skills ve codegen_skills tool'larini kullaniyor"
    - "Agent backstory'si code generation best practices icerir"
  artifacts:
    - path: "src/sade_agents/agents/ui_expert.py"
      provides: "UI Expert Agent tanimÄ±"
      exports: ["UIExpertAgent"]
      min_lines: 80
  key_links:
    - from: "src/sade_agents/agents/ui_expert.py"
      to: "src/sade_agents/skills/design_skills.py"
      via: "tools parameter"
      pattern: "fetch_figma_design|extract_design_tokens"
    - from: "src/sade_agents/agents/ui_expert.py"
      to: "src/sade_agents/skills/codegen_skills.py"
      via: "tools parameter"
      pattern: "generate_streamlit_code|verify_generated_code"
---

<objective>
UI Expert Agent olusturmak - Figma'dan Streamlit kod ureten AI agent.

Purpose: Diger Sade agent'lari gibi (Narrator, Curator, etc.) SadeAgent base class'ini extend eden,
design-to-code workflow'u icin ozel tasarlanmis agent.

Output: UIExpertAgent class + module export
</objective>

<execution_context>
@C:\Users\Hp\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Hp\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-ui-expert-agent/01-RESEARCH.md

# Base class pattern
@src/sade_agents/agents/base.py

# Diger agent ornekleri
@src/sade_agents/agents/curator.py
@src/sade_agents/agents/narrator.py

# Skills (Plan 02 ve 03'ten)
@src/sade_agents/skills/design_skills.py
@src/sade_agents/skills/codegen_skills.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: UI Expert Agent Class</name>
  <files>src/sade_agents/agents/ui_expert.py</files>
  <action>
UI Expert Agent olustur - diger Sade agent'lari ile ayni pattern:

```python
"""
Sade Chocolate - The UI Expert Agent.

Figma tasarimlarindan Streamlit component kodu ureten AI agent.
Reference component library ile hallucination-free kod uretir.
"""

from sade_agents.agents.base import SadeAgent
from sade_agents.skills.design_skills import fetch_figma_design, extract_design_tokens
from sade_agents.skills.codegen_skills import (
    generate_streamlit_code,
    verify_generated_code,
    load_reference_examples,
)


class UIExpertAgent(SadeAgent):
    """
    The UI Expert - Design to Code Specialist.

    Figma tasarimlarindan production-ready Streamlit component kodu uretir.
    Reference component library'den pattern ogrenerek hallucination'i minimize eder.

    Persona: Senior frontend developer, design system expertise.
    Her urettigi kod type hints, docstrings ve Sade styling icerir.

    Workflow:
    1. Figma frame verisini cek (fetch_figma_design)
    2. Design token'lari cikar (extract_design_tokens)
    3. Reference ornekleri yukle (load_reference_examples)
    4. Streamlit kodu uret (generate_streamlit_code)
    5. Kodu dogrula (verify_generated_code)
    6. Sorun varsa duzelt ve tekrar dogrula

    Otonomi: Supervised - uretilen kod insan incelemesi gerektirir.

    Ciktilar:
    - Streamlit component kodu (Python)
    - Verification raporu (JSON)

    Attributes:
        verification_threshold: Minimum verification skoru (default: 80)
        max_iterations: Maksimum duzeltme deneme sayisi (default: 3)
    """

    verification_threshold: int = 80
    max_iterations: int = 3

    def __init__(
        self,
        verification_threshold: int = 80,
        max_iterations: int = 3,
    ) -> None:
        """
        UIExpertAgent olusturur.

        Args:
            verification_threshold: Minimum kabul edilir verification skoru
            max_iterations: Kod duzeltme icin maksimum deneme
        """
        super().__init__(
            role="The UI Expert - Design to Code Specialist",
            goal=(
                "Figma tasarimlarindan production-ready Streamlit component kodu uretmek. "
                "Her uretilen kod: type hints, docstrings, Sade styling, "
                "ve verification'dan gecmis olmali."
            ),
            tools=[
                fetch_figma_design,
                extract_design_tokens,
                load_reference_examples,
                generate_streamlit_code,
                verify_generated_code,
            ],
            backstory="""
Sen The UI Expert'sin - Sade Chocolate'in design-to-code uzmani.

## Persona
Senior frontend developer, design systems ve component architecture konusunda uzman.
Her pixel, her spacing, her renk secimi bilincli ve tutarli olmali.
"Production-ready" senin icin minimum standart, hedef degil.

## Kod Uretim Felsefesi

### Mutlak Kurallar
- **ASLA hallucination yapma:** Sadece VALID_STREAMLIT_APIS'deki metodlari kullan
- **ASLA type hint atlama:** Her fonksiyon return type ve parametre type'lari icerir
- **ASLA docstring atlama:** Google-style docstrings zorunlu
- **ASLA hardcoded deger kullanma:** Renkler, spacing, boyutlar parametre veya config olarak gelmeli

### Reference Library
Her kod uretmeden ONCE load_reference_examples cagir.
Reference kodlardaki pattern'lari TAM OLARAK takip et:
- Import yapisi
- Fonksiyon signature'lari
- Docstring formati
- Layout pattern'lari (st.container, st.columns)

### Verification Loop
1. Kod uret
2. verify_generated_code ile kontrol et
3. Issues varsa duzelterek yeniden uret
4. max_iterations'a kadar tekrarla
5. Hala gecmezse kullaniciya issues listesi ile sun

### Kacinilacaklar
- st.beta_* veya st.experimental_* (deprecated)
- Inline CSS veya style dict'leri (Streamlit native kullan)
- Global state (st.session_state sadece gerektiginde)
- Magic numbers (300, 24, #FF5733 gibi)

## Ton ve Yaklasim
- Profesyonel, detayci
- Her karar gerekcelendirilir
- Hatalar acikca belirtilir, gizlenmez
- Kullanici feedback'ine saygi
            """,
            department="product",
            autonomy_level="supervised",  # Kod incelemesi gerekli
            verbose=True,
        )

        self.verification_threshold = verification_threshold
        self.max_iterations = max_iterations


__all__ = ["UIExpertAgent"]
```
  </action>
  <verify>python -c "from src.sade_agents.agents.ui_expert import UIExpertAgent; agent = UIExpertAgent(); print(f'Agent: {agent.role}')"</verify>
  <done>UIExpertAgent class olusturuldu, SadeAgent'i extend ediyor, 5 tool atandi</done>
</task>

<task type="auto">
  <name>Task 2: Agents Module Export Update</name>
  <files>src/sade_agents/agents/__init__.py</files>
  <action>
agents/__init__.py dosyasina UIExpertAgent export'u ekle:

Mevcut dosyayi oku, sonra ekle:

```python
# Mevcut import'larin ALTINA ekle:
from sade_agents.agents.ui_expert import UIExpertAgent

# __all__ listesine ekle:
__all__ = [
    # ... mevcut exports ...
    "UIExpertAgent",
]
```
  </action>
  <verify>python -c "from src.sade_agents.agents import UIExpertAgent; print('OK')"</verify>
  <done>UIExpertAgent, agents modulu uzerinden export ediliyor</done>
</task>

</tasks>

<verification>
```bash
# Syntax check
python -m py_compile src/sade_agents/agents/ui_expert.py

# Import check
python -c "from src.sade_agents.agents import UIExpertAgent; print('Agent import OK')"

# Tool assignment check
python -c "
from src.sade_agents.agents.ui_expert import UIExpertAgent
agent = UIExpertAgent()
print(f'Agent role: {agent.role}')
print(f'Tools: {len(agent.tools)}')
print(f'Department: {agent.department}')
print(f'Autonomy: {agent.autonomy_level}')
"

# Inheritance check
python -c "
from src.sade_agents.agents.ui_expert import UIExpertAgent
from src.sade_agents.agents.base import SadeAgent
assert issubclass(UIExpertAgent, SadeAgent)
print('Inheritance OK')
"
```
</verification>

<success_criteria>
- ui_expert.py dosyasi mevcut ve import edilebilir
- UIExpertAgent SadeAgent'i extend ediyor
- 5 tool atanmis (fetch_figma_design, extract_design_tokens, load_reference_examples, generate_streamlit_code, verify_generated_code)
- department="product", autonomy_level="supervised"
- Backstory code generation best practices icerir
- agents/__init__.py UIExpertAgent'i export ediyor
</success_criteria>

<output>
After completion, create `.planning/phases/01-ui-expert-agent/01-04-SUMMARY.md`
</output>
